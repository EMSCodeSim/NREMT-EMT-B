<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EMS Scenario</title>
</head>
<body>
  <!-- Chat display section -->
  <div id="chat-display" style="border: 1px solid #ddd; padding: 10px; margin-bottom: 20px; height: 200px; overflow-y: auto;">
    <p>Scenario will appear here...</p>
  </div>
  
  <!-- Button to start the random scenario -->
  <button onclick="startRandomScenario()">Start Scenario</button>

  <!-- JavaScript for handling the scenario -->
  <script>
    async function startRandomScenario() {
      try {
        // Fetch the chest pain scenario JSON file
        const res = await fetch("/scenario/chest_pain_001/pain_001.json");
        const currentScenario = await res.json();
        
        // Initialize variables
        let imageShown = false;
        const history = [];
        
        // Get chat display element
        const chat = document.getElementById("chat-display");
        chat.innerHTML = ""; // Clear previous content
        
        // Add the dispatch message to the chat
        const dispatch = document.createElement("div");
        dispatch.className = "chat-message";
        dispatch.textContent = `üìü Dispatch: ${currentScenario.dispatch}`;
        chat.appendChild(dispatch);

        // Start the timer (assuming there's a startTimer function defined elsewhere)
        const totalTime = 15 * 60;
        startTimer(totalTime);
      } catch (error) {
        // Handle errors by showing a message in the chat
        const chat = document.getElementById("chat-display");
        const errMsg = document.createElement("div");
        errMsg.className = "chat-message";
        errMsg.textContent = "‚ö†Ô∏è Could not load chest pain scenario.";
        chat.appendChild(errMsg);
        console.error("Error loading chest pain scenario:", error);
      }
    }

    // Mock startTimer function (replace or remove if implemented elsewhere)
    function startTimer(totalTime) {
      console.log(`Timer started for ${totalTime} seconds.`);
    }
  </script>
</body>
</html>
